<!-- 
title: How I Discovered a Vulnerability in Moodle Code Runner
excerpt: I noticed a potential flaw in how the Moodle Code Runner executes code. Here's a safe, educational look into how it might be possible to capture hidden test cases, based on my experiments on a local Moodle setup.
author: "Malindu"  
date: "2025-04-27"  
img: "/img/moodle-coderunner-exploit.png"  
pinned: False  
-->

## How I Discovered a Vulnerability in Moodle Code Runner

Recently, while working on some programming labs, I noticed something interesting about how the Moodle Code Runner system behaves.  
This post is purely educational and is based on a **local Moodle setup** I tested on my own server.  
I am **not encouraging** anyone to break rules or misuse this information.

If you choose to try anything similar, you do it **at your own risk**.

---

### 🛠️ What I Observed

The Code Runner runs the code you submit, checks the output, and compares it against hidden test cases.  
But when I looked deeper (on my own local installation), I realized something:

- The system seems to run the submitted code **directly** on the server.
- There are **no strict limits** to prevent network calls.

If that's true for other Moodle installations too, it might be possible to send hidden inputs/output data somewhere else using simple tools.

---

### 🧪 How I Tested (Safely)

On my local Moodle server, I tried the following steps:

1. Set up a small **Python listener** on my PC to catch incoming data.
2. Used **Ngrok** to expose my PC to the internet securely.
3. Wrote a simple **C++ program** that:
   - Listens for input,
   - Sends the received data silently to my PC using `curl`.

When my server ran the code, the hidden inputs were sent to my listener without any issues.

You can find the full method (for educational purposes) here:  
👉 [GitHub: thisismalindu/coderunner-exploit](https://github.com/thisismalindu/coderunner-exploit)

---

### 🚨 Important Disclaimer

I only tested this technique on **my own Moodle server**, not on any official or university system.  
Based on how similar systems work, I believe it might happen elsewhere too — but **I did not test or use it on the real university Moodle**.

This post is meant **for learning only**, to show why securing code runners properly is important.

**Do not** use this method to cheat or violate any policies.

---

### 📚 Final Thoughts

Finding vulnerabilities is part of learning how systems work.  
But with great power comes great responsibility. 😉

If you find issues like this, the best thing is to report them and help make things safer for everyone.